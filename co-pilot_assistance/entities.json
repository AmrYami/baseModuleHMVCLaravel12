{
  "entities": [
    {
      "name": "Hospital",
      "table": "hospitals",
      "fields": ["id", "name", "slug", "description", "is_active", "order", "created_at", "updated_at"],
      "relations": {"forms": {"type": "hasMany", "target": "Form", "fk": "hospital_id"}}
    },
    {
      "name": "Form",
      "table": "forms",
      "fields": ["id", "hospital_id", "name", "key", "version", "published_at", "retired_at", "is_active", "created_at", "updated_at"],
      "unique": ["hospital_id", "key", "version"],
      "relations": {
        "hospital": {"type": "belongsTo", "target": "Hospital", "fk": "hospital_id"},
        "fields":   {"type": "hasMany",  "target": "FormField", "fk": "form_id"}
      }
    },
    {
      "name": "FormField",
      "table": "form_fields",
      "fields": ["id", "form_id", "key", "label", "type", "options", "rules", "ui", "visibility", "required", "policy", "position", "deleted_at", "created_at", "updated_at"],
      "unique": ["form_id", "key", "deleted_at"],
      "relations": {"form": {"type": "belongsTo", "target": "Form", "fk": "form_id"}}
    },
    {
      "name": "Submission",
      "table": "submissions",
      "fields": ["id", "user_id", "form_id", "status", "submitted_at", "created_at", "updated_at"],
      "relations": {
        "form": {"type": "belongsTo", "target": "Form", "fk": "form_id"},
        "values": {"type": "hasMany", "target": "SubmissionValue", "fk": "submission_id"}
      }
    },
    {
      "name": "SubmissionValue",
      "table": "submission_values",
      "fields": ["id", "submission_id", "form_field_id", "value", "edit_count", "locked_at", "created_at", "updated_at"],
      "unique": ["submission_id", "form_field_id"],
      "relations": {
        "submission": {"type": "belongsTo", "target": "Submission", "fk": "submission_id"},
        "field": {"type": "belongsTo", "target": "FormField", "fk": "form_field_id"}
      }
    },
    {
      "name": "Dataset",
      "table": "hr_datasets",
      "fields": ["id", "key", "name", "description", "is_active", "meta", "created_at", "updated_at"],
      "relations": {"items": {"type": "hasMany", "target": "DatasetItem", "fk": "hr_dataset_id"}}
    },
    {
      "name": "DatasetItem",
      "table": "hr_dataset_items",
      "fields": ["id", "hr_dataset_id", "label", "value", "disabled", "position", "extra", "created_at", "updated_at"],
      "relations": {"dataset": {"type": "belongsTo", "target": "Dataset", "fk": "hr_dataset_id"}}
    },
    {
      "name": "ChangeRequest",
      "table": "change_requests",
      "fields": ["id", "submission_id", "form_field_id", "user_id", "current_value", "requested_value", "reason", "status", "decided_by", "decided_at", "created_at", "updated_at"],
      "relations": {
        "submission": {"type": "belongsTo", "target": "Submission", "fk": "submission_id"},
        "field": {"type": "belongsTo", "target": "FormField", "fk": "form_field_id"}
      }
    }
  ]
}

